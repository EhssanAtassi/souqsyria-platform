<div class="slider-image-container"
     [class.rtl]="currentDirection === 'rtl'"
     [class.ltr]="currentDirection === 'ltr'"
     [class.loading]="!isComponentReady"
     [class.has-images]="images && images.length > 0"
     [class.single-image]="images && images.length === 1"
     [class.multiple-images]="images && images.length > 1">

  <!-- Empty state when no images -->
  <div class="empty-state" *ngIf="!images || images.length === 0">
    <div class="empty-icon">ğŸ–¼ï¸</div>
    <p class="empty-message" [innerHTML]="currentDirection === 'rtl' ? 'Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ± Ù„Ù„Ø¹Ø±Ø¶' : 'No images to display'"></p>
  </div>

  <!-- Main Swiper Container -->
  <swiper-container
    #swiperContainer
    *ngIf="images && images.length > 0"
    slides-per-view="1"
    space-between="0"
    [attr.loop]="hasNavigation()"
    [attr.autoplay]="autoplay && hasNavigation() ? 'true' : 'false'"
    [attr.autoplay-delay]="intervalMs"
    [attr.autoplay-disable-on-interaction]="false"
    [attr.autoplay-pause-on-mouse-enter]="pauseOnHover"
    [attr.navigation]="hasNavigation()"
    [attr.pagination]="hasNavigation()"
    pagination-type="fraction"
    grab-cursor="true"
    speed="600"
    effect="slide"
    preload-images="false"
    lazy="true"
    class="hero-swiper"
    init="false"
    [attr.aria-label]="'Image slider with ' + images.length + ' slides'"
    role="region"
  >
    <swiper-slide
      *ngFor="let image of images; let i = index; trackBy: trackByImage"
      class="slide-item"
      [class.clickable]="!!getNavigationUrl(image)"
      (click)="onSlideClick(image, $event)"
      [attr.aria-label]="'Slide ' + (i + 1) + ' of ' + images.length + (image.alt ? ': ' + image.alt : '')"
      [attr.role]="getNavigationUrl(image) ? 'button' : 'img'"
      [attr.tabindex]="getNavigationUrl(image) ? '0' : '-1'"
      (keydown.enter)="onSlideClick(image)"
      (keydown.space)="onSlideClick(image, $event); $event.preventDefault()"
    >
      <!-- Main slide image -->
      <img
        [src]="image.src"
        [alt]="image.alt || 'Slider image ' + (i + 1)"
        class="slide-image"
        loading="lazy"
        (load)="onImageLoad($event, i)"
        (error)="onImageError($event, image, i)"
        [attr.aria-describedby]="getNavigationUrl(image) ? 'slide-description-' + i : null"
        decoding="async"
      />

      <!-- Image overlay with call-to-action -->
      <div
        class="slide-overlay"
        *ngIf="getNavigationUrl(image)"
        [id]="'slide-description-' + i"
        [attr.aria-hidden]="true"
      >
        <div class="overlay-content">
          <span class="click-hint">
            {{ currentDirection === 'rtl' ? 'Ø§Ø¶ØºØ· Ù„Ù„Ù…Ø´Ø§Ù‡Ø¯Ø©' : 'Click to view' }}
          </span>
          <div class="click-icon" [innerHTML]="currentDirection === 'rtl' ? 'â†' : 'â†’'"></div>
        </div>
      </div>

      <!-- Loading indicator for individual slides -->
      <div class="slide-loading-indicator" *ngIf="!isComponentReady">
        <div class="loading-spinner">
          <div class="spinner-ring"></div>
        </div>
        <span class="loading-text">
          {{ currentDirection === 'rtl' ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...' : 'Loading...' }}
        </span>
      </div>

      <!-- Error state for failed images -->
      <div class="slide-error-state"
           *ngIf="image.hasError"
           [attr.aria-label]="currentDirection === 'rtl' ? 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©' : 'Failed to load image'">
        <div class="error-icon">âš ï¸</div>
        <p class="error-message">
          {{ currentDirection === 'rtl' ? 'ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©' : 'Image failed to load' }}
        </p>
      </div>
    </swiper-slide>

    <!-- Custom navigation controls -->
    <div class="custom-navigation" *ngIf="hasNavigation()" role="group" [attr.aria-label]="'Slider navigation'">
      <button
        class="nav-button prev"
        (click)="previousSlide()"
        [attr.aria-label]="currentDirection === 'rtl' ? 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©' : 'Previous image'"
        [attr.title]="currentDirection === 'rtl' ? 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©' : 'Previous image'"
        type="button"
        [disabled]="!hasNavigation()"
      >
        <span class="nav-icon"
              [innerHTML]="currentDirection === 'rtl' ? '&#8250;' : '&#8249;'"
              aria-hidden="true"></span>
        <span class="sr-only">
          {{ currentDirection === 'rtl' ? 'Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©' : 'Go to previous image' }}
        </span>
      </button>

      <button
        class="nav-button next"
        (click)="nextSlide()"
        [attr.aria-label]="currentDirection === 'rtl' ? 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©' : 'Next image'"
        [attr.title]="currentDirection === 'rtl' ? 'Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©' : 'Next image'"
        type="button"
        [disabled]="!hasNavigation()"
      >
        <span class="nav-icon"
              [innerHTML]="currentDirection === 'rtl' ? '&#8249;' : '&#8250;'"
              aria-hidden="true"></span>
        <span class="sr-only">
          {{ currentDirection === 'rtl' ? 'Ø§Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„ØªØ§Ù„ÙŠØ©' : 'Go to next image' }}
        </span>
      </button>
    </div>

    <!-- Progress bar for autoplay -->
    <div class="autoplay-progress"
         *ngIf="autoplay && hasNavigation() && !isAutoplayPaused"
         [style.animation-duration.ms]="intervalMs"
         aria-hidden="true">
    </div>
  </swiper-container>

  <!-- Autoplay status and controls -->
  <div class="autoplay-controls"
       *ngIf="autoplay && hasNavigation()"
       role="group"
       [attr.aria-label]="'Autoplay controls'">

    <!-- Status indicator -->
    <div class="autoplay-status"
         [class.paused]="isAutoplayPaused"
         [attr.aria-live]="'polite'"
         [attr.aria-label]="isAutoplayPaused ?
           (currentDirection === 'rtl' ? 'Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù…ØªÙˆÙ‚Ù' : 'Autoplay paused') :
           (currentDirection === 'rtl' ? 'Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù†Ø´Ø·' : 'Autoplay active')">
      <span class="status-icon" aria-hidden="true">{{ isAutoplayPaused ? 'â¸ï¸' : 'â–¶ï¸' }}</span>
    </div>

    <!-- Manual autoplay toggle -->
    <button class="autoplay-toggle"
            (click)="isAutoplayPaused ? resumeAutoplay() : pauseAutoplay()"
            [attr.aria-label]="isAutoplayPaused ?
              (currentDirection === 'rtl' ? 'ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ' : 'Resume autoplay') :
              (currentDirection === 'rtl' ? 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ' : 'Pause autoplay')"
            [attr.title]="isAutoplayPaused ?
              (currentDirection === 'rtl' ? 'ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ' : 'Resume autoplay') :
              (currentDirection === 'rtl' ? 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ' : 'Pause autoplay')"
            type="button">
      <span aria-hidden="true">{{ isAutoplayPaused ? 'â–¶ï¸' : 'â¸ï¸' }}</span>
    </button>
  </div>

  <!-- Keyboard navigation instructions -->
  <div class="keyboard-instructions sr-only"
       *ngIf="hasNavigation()"
       [attr.aria-label]="'Keyboard navigation instructions'">
    <p>{{ currentDirection === 'rtl' ?
      'Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø£Ø³Ù‡Ù… Ø£Ùˆ Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø³Ø§ÙØ© Ø£Ùˆ Enter Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙˆØ±' :
      'Use arrow keys, space, or enter to navigate through images' }}</p>
  </div>

  <!-- Loading overlay for entire component -->
  <div class="component-loading-overlay" *ngIf="!isComponentReady && images && images.length > 0">
    <div class="loading-content">
      <div class="loading-spinner">
        <div class="spinner-ring"></div>
      </div>
      <p class="loading-message">
        {{ currentDirection === 'rtl' ? 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ù…Ø¹Ø±Ø¶...' : 'Preparing gallery...' }}
      </p>
    </div>
  </div>
</div>
