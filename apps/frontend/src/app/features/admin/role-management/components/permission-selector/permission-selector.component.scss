/**
 * Permission Selector Component Styles
 *
 * @description
 * Main container styles for the permission tree selector with search,
 * action bar, tree display, and empty states.
 */

// ============================================================================
// COMPONENT HOST
// ============================================================================

:host {
  display: block;
  width: 100%;
}

// ============================================================================
// PERMISSION SELECTOR CONTAINER
// ============================================================================

.permission-selector {
  display: flex;
  flex-direction: column;
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.12);
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  position: relative;

  &.loading {
    pointer-events: none;
  }

  &.read-only {
    background: rgba(0, 0, 0, 0.02);
  }
}

// ============================================================================
// ACTION BAR
// ============================================================================

.action-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: rgba(0, 0, 0, 0.02);
  border-bottom: 1px solid rgba(0, 0, 0, 0.12);
  gap: 16px;
}

.selection-summary {
  flex: 1;
  display: flex;
  align-items: center;
  gap: 8px;
}

.summary-text {
  font-size: 14px;
  color: rgba(0, 0, 0, 0.87);

  strong {
    font-weight: 600;
    color: #3f51b5;
  }
}

.actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

// ============================================================================
// LOADING OVERLAY
// ============================================================================

.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 16px;
  background: rgba(255, 255, 255, 0.9);
  z-index: 10;

  p {
    margin: 0;
    font-size: 14px;
    color: rgba(0, 0, 0, 0.6);
  }
}

// ============================================================================
// TREE CONTAINER
// ============================================================================

.tree-container {
  overflow-y: auto;
  overflow-x: hidden;
  position: relative;
  background: white;

  &.has-search {
    // Additional styles when searching
  }

  // Custom scrollbar
  &::-webkit-scrollbar {
    width: 8px;
  }

  &::-webkit-scrollbar-track {
    background: rgba(0, 0, 0, 0.05);
  }

  &::-webkit-scrollbar-thumb {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 4px;

    &:hover {
      background: rgba(0, 0, 0, 0.3);
    }
  }
}

// ============================================================================
// TREE VIEWPORT (VIRTUAL SCROLLING)
// ============================================================================

.tree-viewport {
  height: 100%;
  width: 100%;
}

// ============================================================================
// PERMISSION TREE
// ============================================================================

.permission-tree {
  background: transparent;

  .mat-tree-node {
    min-height: 0;
    padding: 0;
    border: none;
  }
}

.tree-node {
  width: 100%;

  &--category {
    // Category-specific styles handled by child component
  }

  &--permission {
    // Permission-specific styles handled by child component
  }
}

// ============================================================================
// EMPTY STATE
// ============================================================================

.empty-state {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 48px 24px;
  text-align: center;
  color: rgba(0, 0, 0, 0.6);
}

.empty-icon {
  font-size: 64px;
  width: 64px;
  height: 64px;
  color: rgba(0, 0, 0, 0.3);
  margin-bottom: 16px;
}

.empty-state h3 {
  margin: 0 0 8px 0;
  font-size: 18px;
  font-weight: 500;
  color: rgba(0, 0, 0, 0.87);
}

.empty-state p {
  margin: 0 0 24px 0;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.6);
}

// ============================================================================
// FOOTER SUMMARY
// ============================================================================

.footer-summary {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  background: rgba(63, 81, 181, 0.08);
  border-top: 1px solid rgba(63, 81, 181, 0.2);
  gap: 16px;
}

.summary-content {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.87);

  mat-icon {
    font-size: 20px;
    width: 20px;
    height: 20px;
    color: #3f51b5;
  }

  strong {
    font-weight: 600;
    color: #3f51b5;
  }
}

// ============================================================================
// DARK THEME
// ============================================================================

.dark-theme {
  .permission-selector {
    background: #424242;
    border-color: rgba(255, 255, 255, 0.12);

    &.read-only {
      background: rgba(255, 255, 255, 0.05);
    }
  }

  .action-bar {
    background: rgba(255, 255, 255, 0.05);
    border-bottom-color: rgba(255, 255, 255, 0.12);
  }

  .summary-text {
    color: rgba(255, 255, 255, 0.87);

    strong {
      color: #90caf9;
    }
  }

  .loading-overlay {
    background: rgba(66, 66, 66, 0.9);

    p {
      color: rgba(255, 255, 255, 0.7);
    }
  }

  .tree-container {
    background: #424242;

    &::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
    }

    &::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);

      &:hover {
        background: rgba(255, 255, 255, 0.3);
      }
    }
  }

  .empty-state {
    color: rgba(255, 255, 255, 0.7);
  }

  .empty-icon {
    color: rgba(255, 255, 255, 0.3);
  }

  .empty-state h3 {
    color: rgba(255, 255, 255, 0.87);
  }

  .empty-state p {
    color: rgba(255, 255, 255, 0.6);
  }

  .footer-summary {
    background: rgba(63, 81, 181, 0.15);
    border-top-color: rgba(63, 81, 181, 0.3);
  }

  .summary-content {
    color: rgba(255, 255, 255, 0.87);

    mat-icon {
      color: #90caf9;
    }

    strong {
      color: #90caf9;
    }
  }
}

// ============================================================================
// RESPONSIVE ADJUSTMENTS
// ============================================================================

@media (max-width: 768px) {
  .action-bar {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }

  .selection-summary {
    justify-content: center;
  }

  .actions {
    justify-content: space-between;
  }

  .footer-summary {
    flex-direction: column;
    align-items: stretch;
    gap: 12px;
  }

  .summary-content {
    justify-content: center;
  }

  .empty-state {
    padding: 32px 16px;
  }

  .empty-icon {
    font-size: 48px;
    width: 48px;
    height: 48px;
  }
}

@media (max-width: 480px) {
  .action-bar {
    padding: 12px;
  }

  .actions {
    flex-wrap: wrap;

    button {
      flex: 1;
      min-width: calc(50% - 4px);
    }
  }
}

// ============================================================================
// ACCESSIBILITY
// ============================================================================

// Focus visible
.tree-container:focus-visible {
  outline: 2px solid #3f51b5;
  outline-offset: -2px;
}

// High contrast mode
@media (prefers-contrast: high) {
  .permission-selector {
    border-width: 2px;
  }

  .action-bar,
  .footer-summary {
    border-width: 2px;
  }

  .empty-state {
    border: 2px solid rgba(0, 0, 0, 0.3);
    margin: 16px;
    padding: 32px 16px;
  }
}

// Reduced motion
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
    animation: none !important;
  }
}

// Print styles
@media print {
  .action-bar,
  .footer-summary {
    display: none;
  }

  .tree-container {
    max-height: none !important;
    overflow: visible !important;
  }

  .permission-selector {
    box-shadow: none;
    border: 1px solid #000;
  }
}

// ============================================================================
// MATERIAL OVERRIDES
// ============================================================================

// Adjust Material Tree padding
::ng-deep {
  .mat-tree-node {
    min-height: unset;
  }

  .mat-tree {
    background: transparent;
  }

  // Virtual scroll viewport
  .cdk-virtual-scroll-viewport {
    .cdk-virtual-scroll-content-wrapper {
      width: 100%;
    }
  }
}

// ============================================================================
// ANIMATION UTILITIES
// ============================================================================

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes slideDown {
  from {
    transform: translateY(-10px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.permission-selector {
  animation: fadeIn 0.3s ease;
}

.tree-node {
  animation: slideDown 0.2s ease;
}
