<!-- Category Search Container -->
<div
  class="category-search-container"
  [class.rtl]="isRtl"
>
  <!-- Search Input with Material Form Field -->
  <mat-form-field
    appearance="outline"
    class="w-full search-form-field"
    [class.rtl-field]="isRtl"
  >
    <mat-label>{{ placeholder }}</mat-label>

    <!-- Leading Icon -->
    <mat-icon matPrefix class="text-gray-400 dark:text-gray-500">search</mat-icon>

    <!-- Search Input -->
    <input
      matInput
      type="text"
      class="bg-white dark:bg-gray-800 text-gray-900 dark:text-white"
      [value]="searchQuery()"
      (input)="onSearchInput($any($event.target).value)"
      (keydown.enter)="onEnterPress($event)"
      (keydown.escape)="onEscapePress($event)"
      [placeholder]="placeholder"
      [attr.aria-label]="placeholder"
      autocomplete="off"
    />

    <!-- Trailing Icon/Spinner -->
    <button
      *ngIf="!isSearching() && showClearButton()"
      mat-icon-button
      matSuffix
      type="button"
      class="hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors duration-200"
      (click)="clearSearch()"
      [attr.aria-label]="isRtl ? 'مسح البحث' : 'Clear search'"
    >
      <mat-icon class="text-gray-400 dark:text-gray-500">close</mat-icon>
    </button>

    <mat-spinner
      *ngIf="isSearching()"
      matSuffix
      [diameter]="20"
      [strokeWidth]="2"
      class="text-primary-500 dark:text-primary-400"
    ></mat-spinner>

    <!-- Hint for minimum characters -->
    <mat-hint
      *ngIf="searchQuery().length > 0 && searchQuery().length < 2"
      align="start"
      class="text-gray-500 dark:text-gray-400 animate-fade-in"
    >
      {{
        isRtl
          ? 'الرجاء إدخال حرفين على الأقل للبحث'
          : 'Please enter at least 2 characters to search'
      }}
    </mat-hint>
  </mat-form-field>

  <!-- Results Count -->
  <div
    *ngIf="hasSearched() && !isSearching() && results().length > 0"
    class="mt-3 text-sm text-gray-600 dark:text-gray-400 animate-fade-in"
    role="status"
    [attr.aria-live]="'polite'"
  >
    {{
      isRtl
        ? results().length + ' نتيجة'
        : results().length + ' result' + (results().length === 1 ? '' : 's') + ' found'
    }}
  </div>

  <!-- Empty State -->
  <div
    *ngIf="showEmptyState()"
    class="mt-8 flex flex-col items-center justify-center py-8 animate-fade-in"
    role="status"
    [attr.aria-live]="'polite'"
  >
    <mat-icon class="text-gray-300 dark:text-gray-600 mb-3" style="font-size: 64px; width: 64px; height: 64px;">
      search_off
    </mat-icon>
    <p class="text-gray-500 dark:text-gray-400 text-center font-medium">
      {{
        isRtl
          ? 'لم يتم العثور على نتائج'
          : 'No results found'
      }}
    </p>
    <p class="text-gray-400 dark:text-gray-500 text-sm text-center mt-1">
      {{
        isRtl
          ? 'حاول استخدام كلمات مفتاحية مختلفة'
          : 'Try using different keywords'
      }}
    </p>
  </div>
</div>
