<!DOCTYPE html>
<html lang="en" dir="ltr" id="htmlRoot">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Management - SouqSyria Admin Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'golden-wheat': '#988561',
                        'golden-wheat-light': '#b9a779',
                        'golden-wheat-bg': '#edebe0',
                        'forest-green': '#002623',
                        'charcoal': '#161616'
                    }
                }
            }
        }
    </script>

    <style>
        :root {
            --golden-wheat: #988561;
            --golden-wheat-light: #b9a779;
            --golden-wheat-bg: #edebe0;
            --forest-green: #002623;
            --charcoal: #161616;
        }

        .bg-damascus-pattern {
            background-image:
                radial-gradient(circle at 30% 30%, rgba(152, 133, 97, 0.05) 1px, transparent 1px),
                radial-gradient(circle at 70% 70%, rgba(152, 133, 97, 0.05) 1px, transparent 1px);
            background-size: 60px 60px;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--golden-wheat);
            border-radius: 3px;
        }

        .sidebar-transition {
            transition: all 0.3s ease-in-out;
        }

        .stats-card {
            transition: all 0.3s ease;
        }

        .stats-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(152, 133, 97, 0.15);
        }

        .btn-golden {
            background: linear-gradient(135deg, var(--golden-wheat), var(--golden-wheat-light));
            transition: all 0.3s ease;
        }

        .btn-golden:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(152, 133, 97, 0.3);
        }

        .arabic-text {
            font-family: 'Segoe UI', 'Arial Unicode MS', sans-serif;
        }

        .nav-active {
            background: linear-gradient(135deg, var(--golden-wheat), var(--golden-wheat-light));
            color: white;
            box-shadow: 0 4px 12px rgba(152, 133, 97, 0.3);
        }

        .table-hover:hover {
            background-color: rgba(152, 133, 97, 0.05);
        }

        .vendor-avatar {
            background: linear-gradient(135deg, var(--golden-wheat), var(--golden-wheat-light));
        }

        .status-pending { background-color: #fef3c7; color: #92400e; }
        .status-approved { background-color: #d1fae5; color: #065f46; }
        .status-active { background-color: #dbeafe; color: #1e40af; }
        .status-suspended { background-color: #fee2e2; color: #991b1b; }
        .status-rejected { background-color: #fde2e8; color: #be185d; }

        .performance-excellent { color: #059669; }
        .performance-good { color: #0891b2; }
        .performance-average { color: #eab308; }
        .performance-poor { color: #dc2626; }

        .rating-stars {
            color: #fbbf24;
        }

        .commission-tier-premium { background: linear-gradient(135deg, #7c3aed, #a855f7); }
        .commission-tier-gold { background: linear-gradient(135deg, #f59e0b, #fbbf24); }
        .commission-tier-silver { background: linear-gradient(135deg, #6b7280, #9ca3af); }
        .commission-tier-bronze { background: linear-gradient(135deg, #92400e, #a16207); }

        .modal-overlay {
            backdrop-filter: blur(4px);
        }

        .workflow-step {
            position: relative;
            padding: 1rem;
            border-left: 2px solid #e5e7eb;
        }

        .workflow-step.active {
            border-left-color: var(--golden-wheat);
            background-color: rgba(152, 133, 97, 0.05);
        }

        .workflow-step.completed {
            border-left-color: #059669;
        }

        .payout-item {
            border-left: 4px solid;
        }

        .payout-scheduled { border-left-color: #3b82f6; }
        .payout-processing { border-left-color: #eab308; }
        .payout-completed { border-left-color: #059669; }
        .payout-failed { border-left-color: #dc2626; }

        @media (max-width: 768px) {
            .sidebar-mobile {
                transform: translateX(-100%);
            }

            .sidebar-mobile.show {
                transform: translateX(0);
            }

            .main-content-mobile {
                margin-left: 0 !important;
            }
        }
    </style>
</head>
<body class="bg-gray-50 bg-damascus-pattern min-h-screen">
    <!-- Mobile Menu Overlay -->
    <div id="mobileOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden md:hidden"></div>

    <!-- Sidebar -->
    <aside id="sidebar" class="sidebar fixed left-0 top-0 w-64 h-full bg-white shadow-xl z-50 sidebar-transition sidebar-mobile">
        <!-- Logo Section -->
        <div class="p-6 border-b border-gray-100">
            <div class="text-center">
                <h1 class="text-2xl font-bold arabic-text" style="color: var(--golden-wheat);">سوق سوريا</h1>
                <h2 class="text-lg font-semibold text-gray-700">SouqSyria</h2>
                <p class="text-sm text-gray-500 mt-1">Admin Portal</p>
            </div>
        </div>

        <!-- User Info -->
        <div class="p-4 border-b border-gray-100">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-golden-wheat to-golden-wheat-light flex items-center justify-center">
                    <i class="fas fa-user text-white text-sm"></i>
                </div>
                <div>
                    <p class="font-semibold text-gray-800" id="adminName">Admin User</p>
                    <p class="text-xs text-gray-500" id="adminRole">System Administrator</p>
                </div>
            </div>
        </div>

        <!-- Navigation Menu -->
        <nav class="p-4 space-y-2">
            <a href="/admin-dashboard.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-all duration-200">
                <i class="material-icons text-lg">dashboard</i>
                <span class="font-medium">Dashboard</span>
                <span class="text-sm arabic-text mr-auto">لوحة التحكم</span>
            </a>

            <a href="/admin-users.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-all duration-200">
                <i class="material-icons text-lg">people</i>
                <span class="font-medium">Users</span>
                <span class="text-sm arabic-text mr-auto">المستخدمين</span>
            </a>

            <a href="/admin-categories.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-all duration-200">
                <i class="material-icons text-lg">category</i>
                <span class="font-medium">Categories</span>
                <span class="text-sm arabic-text mr-auto">التصنيفات</span>
            </a>

            <a href="/admin-vendors.html" class="nav-item nav-active flex items-center space-x-3 px-4 py-3 rounded-lg transition-all duration-200">
                <i class="material-icons text-lg">store</i>
                <span class="font-medium">Vendors</span>
                <span class="text-sm arabic-text mr-auto">التجار</span>
            </a>

            <a href="/admin-analytics.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-all duration-200">
                <i class="material-icons text-lg">analytics</i>
                <span class="font-medium">Analytics</span>
                <span class="text-sm arabic-text mr-auto">التحليلات</span>
            </a>

            <a href="/admin-financial.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-all duration-200">
                <i class="material-icons text-lg">account_balance</i>
                <span class="font-medium">Financial</span>
                <span class="text-sm arabic-text mr-auto">المالية</span>
            </a>

            <a href="/admin-system.html" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition-all duration-200">
                <i class="material-icons text-lg">settings</i>
                <span class="font-medium">System</span>
                <span class="text-sm arabic-text mr-auto">النظام</span>
            </a>

            <a href="#" onclick="logout()" class="nav-item flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-red-50 hover:text-red-600 transition-all duration-200 text-gray-600">
                <i class="material-icons text-lg">logout</i>
                <span class="font-medium">Logout</span>
                <span class="text-sm arabic-text mr-auto">تسجيل الخروج</span>
            </a>
        </nav>
    </aside>

    <!-- Main Content -->
    <main id="mainContent" class="main-content ml-64 main-content-mobile transition-all duration-300">
        <!-- Top Header -->
        <header class="bg-white shadow-sm border-b border-gray-100 sticky top-0 z-30">
            <div class="px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4">
                        <button id="mobileMenuBtn" class="md:hidden p-2 rounded-lg hover:bg-gray-100">
                            <i class="material-icons">menu</i>
                        </button>
                        <div>
                            <h1 class="text-2xl font-bold text-gray-800">Vendor Management</h1>
                            <p class="text-sm text-gray-500 arabic-text">إدارة التجار والموردين</p>
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <button onclick="toggleLanguage()" class="p-2 rounded-lg hover:bg-gray-100 transition-colors">
                            <i class="material-icons">language</i>
                            <span class="text-sm ml-1" id="currentLang">EN</span>
                        </button>

                        <div class="flex items-center space-x-2 bg-yellow-100 px-3 py-2 rounded-lg">
                            <i class="material-icons text-yellow-600 text-sm">pending_actions</i>
                            <span class="text-sm font-medium text-yellow-800" id="pendingApplications">5 Pending</span>
                        </div>

                        <button onclick="showBulkActions()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-medium flex items-center space-x-2">
                            <i class="material-icons text-sm">checklist</i>
                            <span>Bulk Actions</span>
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Vendor Management Content -->
        <div class="p-6 space-y-6">
            <!-- Stats Overview -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <div class="stats-card bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Total Vendors</p>
                            <p class="text-2xl font-bold text-gray-800 mt-1">248</p>
                        </div>
                        <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="material-icons text-blue-600">store</i>
                        </div>
                    </div>
                    <div class="mt-2 text-xs text-gray-500">+12 this month</div>
                </div>

                <div class="stats-card bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Active Vendors</p>
                            <p class="text-2xl font-bold text-green-600 mt-1">198</p>
                        </div>
                        <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="material-icons text-green-600">check_circle</i>
                        </div>
                    </div>
                    <div class="mt-2 text-xs text-gray-500">79.8% of total</div>
                </div>

                <div class="stats-card bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Pending Review</p>
                            <p class="text-2xl font-bold text-yellow-600 mt-1">5</p>
                        </div>
                        <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center">
                            <i class="material-icons text-yellow-600">pending</i>
                        </div>
                    </div>
                    <div class="mt-2 text-xs text-gray-500">Avg. 3 days</div>
                </div>

                <div class="stats-card bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Premium Tier</p>
                            <p class="text-2xl font-bold text-purple-600 mt-1">23</p>
                        </div>
                        <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="material-icons text-purple-600">star</i>
                        </div>
                    </div>
                    <div class="mt-2 text-xs text-gray-500">9.3% of active</div>
                </div>

                <div class="stats-card bg-white rounded-xl p-4 shadow-sm border border-gray-100">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm font-medium">Avg. Performance</p>
                            <p class="text-2xl font-bold text-gray-800 mt-1">4.2</p>
                        </div>
                        <div class="w-10 h-10 bg-gradient-to-br from-golden-wheat to-golden-wheat-light rounded-lg flex items-center justify-center">
                            <i class="material-icons text-white">analytics</i>
                        </div>
                    </div>
                    <div class="mt-2 text-xs rating-stars">★★★★☆</div>
                </div>
            </div>

            <!-- Vendor Management Tabs -->
            <div class="bg-white rounded-xl shadow-sm border border-gray-100">
                <div class="border-b border-gray-100">
                    <nav class="flex space-x-8 px-6">
                        <button onclick="switchTab('vendors')" class="tab-btn active py-4 px-2 border-b-2 border-golden-wheat font-medium text-golden-wheat text-sm">
                            All Vendors
                        </button>
                        <button onclick="switchTab('applications')" class="tab-btn py-4 px-2 border-b-2 border-transparent font-medium text-gray-500 text-sm hover:text-gray-700">
                            Pending Applications <span class="bg-yellow-500 text-white px-2 py-1 rounded-full text-xs ml-2">5</span>
                        </button>
                        <button onclick="switchTab('performance')" class="tab-btn py-4 px-2 border-b-2 border-transparent font-medium text-gray-500 text-sm hover:text-gray-700">
                            Performance Review
                        </button>
                        <button onclick="switchTab('payouts')" class="tab-btn py-4 px-2 border-b-2 border-transparent font-medium text-gray-500 text-sm hover:text-gray-700">
                            Payouts & Commission
                        </button>
                    </nav>
                </div>

                <!-- All Vendors Tab -->
                <div id="vendorsTab" class="tab-content">
                    <!-- Filters -->
                    <div class="p-6 border-b border-gray-100">
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                            <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4">
                                <div class="relative">
                                    <input type="text" id="vendorSearch" placeholder="Search vendors..." class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-golden-wheat focus:border-golden-wheat">
                                    <i class="material-icons absolute left-3 top-2.5 text-gray-400 text-lg">search</i>
                                </div>

                                <select id="statusFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-golden-wheat focus:border-golden-wheat">
                                    <option value="">All Status</option>
                                    <option value="active">Active</option>
                                    <option value="pending">Pending</option>
                                    <option value="suspended">Suspended</option>
                                    <option value="rejected">Rejected</option>
                                </select>

                                <select id="governorateFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-golden-wheat focus:border-golden-wheat">
                                    <option value="">All Governorates</option>
                                    <option value="damascus">Damascus - دمشق</option>
                                    <option value="aleppo">Aleppo - حلب</option>
                                    <option value="homs">Homs - حمص</option>
                                    <option value="hama">Hama - حماة</option>
                                    <option value="latakia">Latakia - اللاذقية</option>
                                </select>

                                <select id="tierFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-golden-wheat focus:border-golden-wheat">
                                    <option value="">All Tiers</option>
                                    <option value="premium">Premium</option>
                                    <option value="gold">Gold</option>
                                    <option value="silver">Silver</option>
                                    <option value="bronze">Bronze</option>
                                </select>
                            </div>

                            <button onclick="exportVendors()" class="flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                                <i class="material-icons text-sm">file_download</i>
                                <span>Export</span>
                            </button>
                        </div>
                    </div>

                    <!-- Vendors Table -->
                    <div class="overflow-x-auto">
                        <table class="w-full" id="vendorsTable">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                        <input type="checkbox" id="selectAll" class="rounded border-gray-300">
                                    </th>
                                    <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Vendor</th>
                                    <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                                    <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Performance</th>
                                    <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Revenue</th>
                                    <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="vendorsTableBody" class="bg-white divide-y divide-gray-100">
                                <!-- Vendor rows will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Pending Applications Tab -->
                <div id="applicationsTab" class="tab-content hidden">
                    <div class="p-6">
                        <div class="space-y-6" id="pendingApplicationsList">
                            <!-- Pending applications will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Performance Review Tab -->
                <div id="performanceTab" class="tab-content hidden">
                    <div class="p-6">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Performance Chart -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h3 class="text-lg font-semibold text-gray-800 mb-4">Vendor Performance Distribution</h3>
                                <canvas id="performanceChart" height="200"></canvas>
                            </div>

                            <!-- Top Performers -->
                            <div class="space-y-4">
                                <h3 class="text-lg font-semibold text-gray-800">Top Performing Vendors</h3>
                                <div id="topPerformers">
                                    <!-- Top performers will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Payouts Tab -->
                <div id="payoutsTab" class="tab-content hidden">
                    <div class="p-6">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Payout Statistics -->
                            <div class="bg-gray-50 rounded-lg p-6">
                                <h3 class="text-lg font-semibold text-gray-800 mb-4">Monthly Payout Overview</h3>
                                <div class="space-y-4">
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Total Scheduled</span>
                                        <span class="font-semibold">₪ 2.4M ($960)</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Processing</span>
                                        <span class="font-semibold text-yellow-600">₪ 850K ($340)</span>
                                    </div>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-600">Completed</span>
                                        <span class="font-semibold text-green-600">₪ 1.55M ($620)</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Recent Payouts -->
                            <div>
                                <h3 class="text-lg font-semibold text-gray-800 mb-4">Recent Payouts</h3>
                                <div class="space-y-3" id="recentPayouts">
                                    <!-- Recent payouts will be populated by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Vendor Details Modal -->
    <div id="vendorModal" class="fixed inset-0 bg-black bg-opacity-50 modal-overlay z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-screen overflow-y-auto">
                <div class="p-6 border-b border-gray-100">
                    <div class="flex items-center justify-between">
                        <h3 class="text-lg font-semibold text-gray-800" id="vendorModalTitle">Vendor Details</h3>
                        <button onclick="closeVendorModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                            <i class="material-icons">close</i>
                        </button>
                    </div>
                </div>
                <div id="vendorModalContent" class="p-6">
                    <!-- Content will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * SouqSyria Vendor Management System
         * Comprehensive vendor management with Syrian business context
         */

        // Global state
        let currentUser = null;
        let currentLanguage = 'en';
        let vendors = [];
        let filteredVendors = [];
        let pendingApplications = [];
        let currentTab = 'vendors';

        /**
         * Sample vendors data with Syrian context
         */
        const sampleVendors = [
            {
                id: 1,
                businessName: 'Damascus Steel Masters',
                businessNameArabic: 'أسياد الفولاذ الدمشقي',
                ownerName: 'Ahmad Al-Hadad',
                email: 'ahmad@damascussteel.sy',
                phone: '+963-11-2345678',
                governorate: 'damascus',
                city: 'Damascus Old City',
                specialties: ['Damascus Steel', 'Traditional Knives', 'Decorative Swords'],
                status: 'active',
                tier: 'premium',
                rating: 4.8,
                totalProducts: 67,
                totalOrders: 1247,
                monthlyRevenue: 850000, // SYP
                commission: 8.5,
                joinDate: '2023-03-15',
                lastActivity: '2024-01-15T10:30:00Z',
                performance: {
                    orderFulfillment: 98,
                    customerSatisfaction: 96,
                    responseTime: 94,
                    qualityScore: 97
                },
                payoutInfo: {
                    method: 'Bank Transfer',
                    account: 'Syrian International Islamic Bank',
                    lastPayout: 680000,
                    nextPayoutDate: '2024-01-25'
                }
            },
            {
                id: 2,
                businessName: 'Aleppo Heritage Crafts',
                businessNameArabic: 'حرف التراث الحلبي',
                ownerName: 'Fatima Al-Sabuni',
                email: 'fatima@aleppoheritage.sy',
                phone: '+963-21-3456789',
                governorate: 'aleppo',
                city: 'Aleppo',
                specialties: ['Laurel Soap', 'Traditional Textiles', 'Handicrafts'],
                status: 'active',
                tier: 'gold',
                rating: 4.6,
                totalProducts: 89,
                totalOrders: 892,
                monthlyRevenue: 420000,
                commission: 12.0,
                joinDate: '2023-07-22',
                lastActivity: '2024-01-14T16:20:00Z',
                performance: {
                    orderFulfillment: 95,
                    customerSatisfaction: 94,
                    responseTime: 91,
                    qualityScore: 93
                },
                payoutInfo: {
                    method: 'Mobile Payment',
                    account: 'Syriatel Cash',
                    lastPayout: 336000,
                    nextPayoutDate: '2024-01-25'
                }
            },
            {
                id: 3,
                businessName: 'Homs Spice Market',
                businessNameArabic: 'سوق التوابل الحمصي',
                ownerName: 'Omar Khoury',
                email: 'omar@homsspices.sy',
                phone: '+963-31-4567890',
                governorate: 'homs',
                city: 'Homs',
                specialties: ['Traditional Spices', 'Seven Spice Mix', 'Dried Herbs'],
                status: 'active',
                tier: 'silver',
                rating: 4.3,
                totalProducts: 156,
                totalOrders: 654,
                monthlyRevenue: 280000,
                commission: 15.0,
                joinDate: '2023-09-10',
                lastActivity: '2024-01-13T12:45:00Z',
                performance: {
                    orderFulfillment: 92,
                    customerSatisfaction: 90,
                    responseTime: 88,
                    qualityScore: 91
                },
                payoutInfo: {
                    method: 'Bank Transfer',
                    account: 'Commercial Bank of Syria',
                    lastPayout: 238000,
                    nextPayoutDate: '2024-01-25'
                }
            },
            {
                id: 4,
                businessName: 'Lattakia Coastal Crafts',
                businessNameArabic: 'حرف الساحل اللاذقاني',
                ownerName: 'Layla Mansour',
                email: 'layla@lattakiacrafts.sy',
                phone: '+963-41-5678901',
                governorate: 'latakia',
                city: 'Lattakia',
                specialties: ['Marine Jewelry', 'Coastal Decor', 'Seashell Crafts'],
                status: 'pending',
                tier: 'bronze',
                rating: 4.1,
                totalProducts: 43,
                totalOrders: 287,
                monthlyRevenue: 145000,
                commission: 18.0,
                joinDate: '2024-01-05',
                lastActivity: '2024-01-12T09:15:00Z',
                performance: {
                    orderFulfillment: 89,
                    customerSatisfaction: 87,
                    responseTime: 85,
                    qualityScore: 88
                },
                payoutInfo: {
                    method: 'Pending Setup',
                    account: '',
                    lastPayout: 0,
                    nextPayoutDate: ''
                }
            },
            {
                id: 5,
                businessName: 'Tartus Traditional Sweets',
                businessNameArabic: 'حلويات طرطوس التراثية',
                ownerName: 'Khalil Zahra',
                email: 'khalil@tartussweets.sy',
                phone: '+963-43-6789012',
                governorate: 'tartus',
                city: 'Tartus',
                specialties: ['Traditional Sweets', 'Baklava', 'Mamoul'],
                status: 'suspended',
                tier: 'silver',
                rating: 3.8,
                totalProducts: 34,
                totalOrders: 198,
                monthlyRevenue: 95000,
                commission: 15.0,
                joinDate: '2023-11-20',
                lastActivity: '2024-01-08T14:30:00Z',
                performance: {
                    orderFulfillment: 78,
                    customerSatisfaction: 82,
                    responseTime: 76,
                    qualityScore: 85
                },
                payoutInfo: {
                    method: 'On Hold',
                    account: 'Payment suspended',
                    lastPayout: 80750,
                    nextPayoutDate: 'Pending Review'
                }
            }
        ];

        /**
         * Sample pending applications
         */
        const sampleApplications = [
            {
                id: 101,
                businessName: 'New Damascus Artisans',
                businessNameArabic: 'حرفيو دمشق الجدد',
                ownerName: 'Yusuf Al-Dimashqi',
                email: 'yusuf@newdamascus.sy',
                phone: '+963-11-7890123',
                governorate: 'damascus',
                specialties: ['Wood Carving', 'Inlay Work', 'Traditional Furniture'],
                applicationDate: '2024-01-10',
                status: 'pending',
                documents: {
                    businessLicense: 'uploaded',
                    taxCertificate: 'uploaded',
                    identityCard: 'uploaded',
                    bankAccount: 'pending'
                },
                reviewNotes: 'Experienced artisan with 15+ years in traditional woodwork'
            },
            {
                id: 102,
                businessName: 'Aleppo Modern Soaps',
                businessNameArabic: 'صابون حلب العصري',
                ownerName: 'Sara Kabbani',
                email: 'sara@aleppomodern.sy',
                phone: '+963-21-8901234',
                governorate: 'aleppo',
                specialties: ['Modern Soap Design', 'Natural Ingredients', 'Gift Sets'],
                applicationDate: '2024-01-12',
                status: 'pending',
                documents: {
                    businessLicense: 'uploaded',
                    taxCertificate: 'uploaded',
                    identityCard: 'uploaded',
                    bankAccount: 'uploaded'
                },
                reviewNotes: 'Innovative approach to traditional soap making'
            }
        ];

        /**
         * Initialize the application
         */
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthentication();
            initializeMobileMenu();
            loadVendors();
            loadPendingApplications();
            setupEventListeners();
            initializeCharts();
        });

        /**
         * Check authentication and load user data
         */
        function checkAuthentication() {
            const userData = localStorage.getItem('souqsyria_admin_user');
            if (!userData) {
                alert('Session expired. Please login again.');
                window.location.href = '/admin-login.html';
                return;
            }

            try {
                currentUser = JSON.parse(userData);
                displayUserInfo();
            } catch (error) {
                console.error('Error parsing user data:', error);
                localStorage.removeItem('souqsyria_admin_user');
                window.location.href = '/admin-login.html';
            }
        }

        /**
         * Display user information
         */
        function displayUserInfo() {
            if (!currentUser) return;
            document.getElementById('adminName').textContent = currentUser.name || 'Admin User';

            const roleElement = document.getElementById('adminRole');
            if (currentUser.role === 'admin') {
                roleElement.textContent = 'System Administrator';
                roleElement.style.color = 'var(--golden-wheat)';
            }
        }

        /**
         * Load and display vendors
         */
        function loadVendors() {
            vendors = [...sampleVendors];
            filteredVendors = [...vendors];
            renderVendors();
        }

        /**
         * Load pending applications
         */
        function loadPendingApplications() {
            pendingApplications = [...sampleApplications];
            document.getElementById('pendingApplications').textContent = `${pendingApplications.length} Pending`;
            renderPendingApplications();
        }

        /**
         * Render vendors table
         */
        function renderVendors() {
            const tbody = document.getElementById('vendorsTableBody');

            tbody.innerHTML = filteredVendors.map(vendor => `
                <tr class="table-hover">
                    <td class="px-6 py-4">
                        <input type="checkbox" class="vendor-checkbox rounded border-gray-300" value="${vendor.id}">
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center space-x-3">
                            <div class="w-10 h-10 rounded-full vendor-avatar flex items-center justify-center text-white font-semibold">
                                ${vendor.businessName.split(' ').map(n => n[0]).slice(0, 2).join('')}
                            </div>
                            <div>
                                <p class="font-semibold text-gray-800">${vendor.businessName}</p>
                                <p class="text-sm text-gray-500 arabic-text">${vendor.businessNameArabic}</p>
                                <p class="text-xs text-gray-400">${vendor.ownerName}</p>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div>
                            <p class="text-sm text-gray-800">${getGovernorateDisplayName(vendor.governorate)}</p>
                            <p class="text-xs text-gray-500">${vendor.city}</p>
                            <div class="flex items-center mt-1">
                                <span class="commission-tier-${vendor.tier} text-white text-xs px-2 py-1 rounded-full">${vendor.tier.toUpperCase()}</span>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="space-y-1">
                            <div class="flex items-center space-x-2">
                                <span class="rating-stars text-sm">★</span>
                                <span class="text-sm font-medium">${vendor.rating}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-gradient-to-r from-golden-wheat to-golden-wheat-light h-2 rounded-full"
                                     style="width: ${(vendor.performance.orderFulfillment)}%"></div>
                            </div>
                            <p class="text-xs text-gray-500">${vendor.performance.orderFulfillment}% fulfillment</p>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <div class="text-right">
                            <p class="font-semibold text-gray-800">₪ ${(vendor.monthlyRevenue / 1000).toFixed(0)}K</p>
                            <p class="text-xs text-gray-500">($${Math.round(vendor.monthlyRevenue / 2500)})</p>
                            <p class="text-xs text-gray-400">${vendor.commission}% commission</p>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="status-${vendor.status} px-3 py-1 text-xs font-medium rounded-full">
                            ${vendor.status.charAt(0).toUpperCase() + vendor.status.slice(1)}
                        </span>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex space-x-2">
                            <button onclick="viewVendorDetails(${vendor.id})" class="text-blue-600 hover:text-blue-800" title="View Details">
                                <i class="material-icons text-sm">visibility</i>
                            </button>
                            <button onclick="editVendor(${vendor.id})" class="text-green-600 hover:text-green-800" title="Edit">
                                <i class="material-icons text-sm">edit</i>
                            </button>
                            <button onclick="toggleVendorStatus(${vendor.id})" class="text-yellow-600 hover:text-yellow-800" title="Toggle Status">
                                <i class="material-icons text-sm">${vendor.status === 'active' ? 'pause_circle' : 'play_circle'}</i>
                            </button>
                            <button onclick="contactVendor(${vendor.id})" class="text-purple-600 hover:text-purple-800" title="Contact">
                                <i class="material-icons text-sm">mail</i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        /**
         * Render pending applications
         */
        function renderPendingApplications() {
            const container = document.getElementById('pendingApplicationsList');

            container.innerHTML = pendingApplications.map(app => `
                <div class="bg-white border border-gray-200 rounded-lg p-6">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3 mb-3">
                                <div class="w-12 h-12 rounded-full vendor-avatar flex items-center justify-center text-white font-semibold text-lg">
                                    ${app.businessName.split(' ').map(n => n[0]).slice(0, 2).join('')}
                                </div>
                                <div>
                                    <h4 class="font-semibold text-gray-800">${app.businessName}</h4>
                                    <p class="text-sm text-gray-500 arabic-text">${app.businessNameArabic}</p>
                                    <p class="text-sm text-gray-600">${app.ownerName}</p>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                                <div>
                                    <p class="text-sm text-gray-600"><strong>Location:</strong> ${getGovernorateDisplayName(app.governorate)}</p>
                                    <p class="text-sm text-gray-600"><strong>Email:</strong> ${app.email}</p>
                                    <p class="text-sm text-gray-600"><strong>Phone:</strong> ${app.phone}</p>
                                </div>
                                <div>
                                    <p class="text-sm text-gray-600"><strong>Applied:</strong> ${formatDate(app.applicationDate)}</p>
                                    <p class="text-sm text-gray-600"><strong>Specialties:</strong></p>
                                    <div class="flex flex-wrap gap-1 mt-1">
                                        ${app.specialties.map(specialty =>
                                            `<span class="bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs">${specialty}</span>`
                                        ).join('')}
                                    </div>
                                </div>
                            </div>

                            <!-- Document Status -->
                            <div class="mb-4">
                                <p class="text-sm font-medium text-gray-700 mb-2">Document Verification Status:</p>
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
                                    ${Object.entries(app.documents).map(([doc, status]) => `
                                        <div class="flex items-center space-x-2">
                                            <i class="material-icons text-sm ${status === 'uploaded' ? 'text-green-500' : 'text-yellow-500'}">
                                                ${status === 'uploaded' ? 'check_circle' : 'pending'}
                                            </i>
                                            <span class="text-xs capitalize">${doc.replace(/([A-Z])/g, ' $1').trim()}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>

                            <div class="bg-gray-50 p-3 rounded">
                                <p class="text-sm text-gray-600"><strong>Review Notes:</strong></p>
                                <p class="text-sm text-gray-800 mt-1">${app.reviewNotes}</p>
                            </div>
                        </div>

                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="approveVendor(${app.id})" class="btn-golden text-white px-4 py-2 rounded text-sm font-medium">
                                Approve
                            </button>
                            <button onclick="requestMoreInfo(${app.id})" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded text-sm font-medium">
                                Request Info
                            </button>
                            <button onclick="rejectVendor(${app.id})" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded text-sm font-medium">
                                Reject
                            </button>
                            <button onclick="viewFullApplication(${app.id})" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded text-sm font-medium">
                                View Full
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        /**
         * Setup event listeners
         */
        function setupEventListeners() {
            // Search functionality
            document.getElementById('vendorSearch').addEventListener('input', debounce(filterVendors, 300));

            // Filter functionality
            document.getElementById('statusFilter').addEventListener('change', filterVendors);
            document.getElementById('governorateFilter').addEventListener('change', filterVendors);
            document.getElementById('tierFilter').addEventListener('change', filterVendors);

            // Select all functionality
            document.getElementById('selectAll').addEventListener('change', function() {
                const checkboxes = document.querySelectorAll('.vendor-checkbox');
                checkboxes.forEach(cb => cb.checked = this.checked);
            });
        }

        /**
         * Tab switching
         */
        function switchTab(tabName) {
            currentTab = tabName;

            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active', 'border-golden-wheat', 'text-golden-wheat');
                btn.classList.add('border-transparent', 'text-gray-500');
            });

            document.querySelector(`button[onclick="switchTab('${tabName}')"]`).classList.add('active', 'border-golden-wheat', 'text-golden-wheat');
            document.querySelector(`button[onclick="switchTab('${tabName}')"]`).classList.remove('border-transparent', 'text-gray-500');

            // Show/hide tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });

            document.getElementById(tabName + 'Tab').classList.remove('hidden');

            // Load tab-specific data
            if (tabName === 'performance') {
                renderPerformanceReview();
            } else if (tabName === 'payouts') {
                renderPayouts();
            }
        }

        /**
         * Filter vendors
         */
        function filterVendors() {
            const searchTerm = document.getElementById('vendorSearch').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const governorateFilter = document.getElementById('governorateFilter').value;
            const tierFilter = document.getElementById('tierFilter').value;

            filteredVendors = vendors.filter(vendor => {
                const matchesSearch = !searchTerm ||
                    vendor.businessName.toLowerCase().includes(searchTerm) ||
                    vendor.businessNameArabic.includes(searchTerm) ||
                    vendor.ownerName.toLowerCase().includes(searchTerm);

                const matchesStatus = !statusFilter || vendor.status === statusFilter;
                const matchesGovernorate = !governorateFilter || vendor.governorate === governorateFilter;
                const matchesTier = !tierFilter || vendor.tier === tierFilter;

                return matchesSearch && matchesStatus && matchesGovernorate && matchesTier;
            });

            renderVendors();
        }

        /**
         * Initialize charts
         */
        function initializeCharts() {
            // Performance chart will be initialized when performance tab is shown
        }

        /**
         * Render performance review
         */
        function renderPerformanceReview() {
            // Initialize performance chart
            const ctx = document.getElementById('performanceChart').getContext('2d');

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Excellent (4.5+)', 'Good (3.5-4.4)', 'Average (2.5-3.4)', 'Poor (<2.5)'],
                    datasets: [{
                        label: 'Number of Vendors',
                        data: [23, 89, 47, 12],
                        backgroundColor: [
                            '#059669',
                            '#0891b2',
                            '#eab308',
                            '#dc2626'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false
                }
            });

            // Render top performers
            const topPerformersContainer = document.getElementById('topPerformers');
            const topPerformers = [...vendors]
                .filter(v => v.status === 'active')
                .sort((a, b) => b.rating - a.rating)
                .slice(0, 5);

            topPerformersContainer.innerHTML = topPerformers.map((vendor, index) => `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-3">
                        <span class="w-6 h-6 bg-golden-wheat text-white rounded-full flex items-center justify-center text-xs font-bold">
                            ${index + 1}
                        </span>
                        <div>
                            <p class="font-medium text-gray-800">${vendor.businessName}</p>
                            <p class="text-sm text-gray-500">${vendor.ownerName}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="font-semibold text-gray-800">${vendor.rating}★</p>
                        <p class="text-xs text-gray-500">${vendor.totalOrders} orders</p>
                    </div>
                </div>
            `).join('');
        }

        /**
         * Render payouts
         */
        function renderPayouts() {
            const recentPayoutsContainer = document.getElementById('recentPayouts');

            const recentPayouts = vendors
                .filter(v => v.payoutInfo.lastPayout > 0)
                .sort((a, b) => new Date(b.payoutInfo.nextPayoutDate) - new Date(a.payoutInfo.nextPayoutDate))
                .slice(0, 6);

            recentPayoutsContainer.innerHTML = recentPayouts.map(vendor => `
                <div class="payout-item payout-completed bg-gray-50 p-3 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="font-medium text-gray-800">${vendor.businessName}</p>
                            <p class="text-sm text-gray-500">${vendor.payoutInfo.method}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold text-gray-800">₪ ${vendor.payoutInfo.lastPayout.toLocaleString()}</p>
                            <p class="text-xs text-gray-500">Next: ${vendor.payoutInfo.nextPayoutDate}</p>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        /**
         * Vendor actions
         */
        function viewVendorDetails(vendorId) {
            const vendor = vendors.find(v => v.id === vendorId);
            if (!vendor) return;

            document.getElementById('vendorModalTitle').textContent = `${vendor.businessName} - Details`;
            document.getElementById('vendorModalContent').innerHTML = `
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">Business Information</h4>
                        <div class="space-y-2 text-sm">
                            <p><strong>Business Name:</strong> ${vendor.businessName}</p>
                            <p><strong>Arabic Name:</strong> ${vendor.businessNameArabic}</p>
                            <p><strong>Owner:</strong> ${vendor.ownerName}</p>
                            <p><strong>Email:</strong> ${vendor.email}</p>
                            <p><strong>Phone:</strong> ${vendor.phone}</p>
                            <p><strong>Location:</strong> ${vendor.city}, ${getGovernorateDisplayName(vendor.governorate)}</p>
                            <p><strong>Tier:</strong> <span class="commission-tier-${vendor.tier} text-white px-2 py-1 rounded text-xs">${vendor.tier.toUpperCase()}</span></p>
                            <p><strong>Join Date:</strong> ${formatDate(vendor.joinDate)}</p>
                        </div>

                        <h4 class="font-semibold text-gray-800 mb-3 mt-6">Specialties</h4>
                        <div class="flex flex-wrap gap-2">
                            ${vendor.specialties.map(specialty =>
                                `<span class="bg-golden-wheat text-white px-3 py-1 rounded-full text-sm">${specialty}</span>`
                            ).join('')}
                        </div>
                    </div>

                    <div>
                        <h4 class="font-semibold text-gray-800 mb-3">Performance Metrics</h4>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Order Fulfillment</span>
                                    <span>${vendor.performance.orderFulfillment}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-green-500 h-2 rounded-full" style="width: ${vendor.performance.orderFulfillment}%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Customer Satisfaction</span>
                                    <span>${vendor.performance.customerSatisfaction}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-blue-500 h-2 rounded-full" style="width: ${vendor.performance.customerSatisfaction}%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Response Time</span>
                                    <span>${vendor.performance.responseTime}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-yellow-500 h-2 rounded-full" style="width: ${vendor.performance.responseTime}%"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Quality Score</span>
                                    <span>${vendor.performance.qualityScore}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-purple-500 h-2 rounded-full" style="width: ${vendor.performance.qualityScore}%"></div>
                                </div>
                            </div>
                        </div>

                        <h4 class="font-semibold text-gray-800 mb-3 mt-6">Revenue & Commission</h4>
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <p class="text-sm"><strong>Monthly Revenue:</strong> ₪ ${vendor.monthlyRevenue.toLocaleString()}</p>
                            <p class="text-sm"><strong>Commission Rate:</strong> ${vendor.commission}%</p>
                            <p class="text-sm"><strong>Total Products:</strong> ${vendor.totalProducts}</p>
                            <p class="text-sm"><strong>Total Orders:</strong> ${vendor.totalOrders.toLocaleString()}</p>
                            <p class="text-sm"><strong>Rating:</strong> ${vendor.rating}★</p>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('vendorModal').classList.remove('hidden');
        }

        function closeVendorModal() {
            document.getElementById('vendorModal').classList.add('hidden');
        }

        function editVendor(vendorId) {
            alert(`Edit vendor functionality would open a comprehensive form for vendor ID ${vendorId}`);
        }

        function toggleVendorStatus(vendorId) {
            const vendor = vendors.find(v => v.id === vendorId);
            if (!vendor) return;

            const newStatus = vendor.status === 'active' ? 'suspended' : 'active';
            const confirmed = confirm(`Are you sure you want to ${newStatus === 'active' ? 'activate' : 'suspend'} ${vendor.businessName}?`);

            if (confirmed) {
                vendor.status = newStatus;
                filterVendors();
                showNotification(`Vendor ${newStatus === 'active' ? 'activated' : 'suspended'} successfully`, 'success');
            }
        }

        function contactVendor(vendorId) {
            const vendor = vendors.find(v => v.id === vendorId);
            if (!vendor) return;

            alert(`Contact vendor functionality would open email/SMS interface for ${vendor.businessName}\n\nEmail: ${vendor.email}\nPhone: ${vendor.phone}`);
        }

        function approveVendor(applicationId) {
            const confirmed = confirm('Are you sure you want to approve this vendor application?');
            if (confirmed) {
                pendingApplications = pendingApplications.filter(app => app.id !== applicationId);
                renderPendingApplications();
                document.getElementById('pendingApplications').textContent = `${pendingApplications.length} Pending`;
                showNotification('Vendor application approved successfully', 'success');
            }
        }

        function requestMoreInfo(applicationId) {
            alert('Request more information functionality would open a form to specify what additional documents or information are needed from the vendor.');
        }

        function rejectVendor(applicationId) {
            const reason = prompt('Please provide a reason for rejection:');
            if (reason) {
                pendingApplications = pendingApplications.filter(app => app.id !== applicationId);
                renderPendingApplications();
                document.getElementById('pendingApplications').textContent = `${pendingApplications.length} Pending`;
                showNotification('Vendor application rejected', 'info');
            }
        }

        function viewFullApplication(applicationId) {
            alert('View full application functionality would show complete application details, uploaded documents, and verification status.');
        }

        function exportVendors() {
            const csv = generateVendorCSV(filteredVendors);
            downloadCSV(csv, `souqsyria_vendors_${new Date().toISOString().split('T')[0]}.csv`);
            showNotification('Vendor data exported successfully', 'success');
        }

        function showBulkActions() {
            const selectedVendors = Array.from(document.querySelectorAll('.vendor-checkbox:checked')).map(cb => cb.value);

            if (selectedVendors.length === 0) {
                alert('Please select at least one vendor to perform bulk actions.');
                return;
            }

            const action = prompt(`${selectedVendors.length} vendors selected. Choose action:\n\n1. Activate\n2. Suspend\n3. Change Tier\n4. Send Message\n5. Export Selected\n\nEnter number (1-5):`);

            switch (action) {
                case '1':
                    bulkUpdateStatus(selectedVendors, 'active');
                    break;
                case '2':
                    bulkUpdateStatus(selectedVendors, 'suspended');
                    break;
                case '3':
                    bulkChangeTier(selectedVendors);
                    break;
                case '4':
                    bulkSendMessage(selectedVendors);
                    break;
                case '5':
                    exportSelectedVendors(selectedVendors);
                    break;
                default:
                    alert('Invalid selection');
            }
        }

        function bulkUpdateStatus(vendorIds, status) {
            const confirmed = confirm(`Are you sure you want to ${status} ${vendorIds.length} vendors?`);
            if (confirmed) {
                vendorIds.forEach(id => {
                    const vendor = vendors.find(v => v.id == id);
                    if (vendor) vendor.status = status;
                });
                filterVendors();
                showNotification(`${vendorIds.length} vendors updated successfully`, 'success');
            }
        }

        /**
         * Utility functions
         */
        function getGovernorateDisplayName(governorate) {
            const governorateNames = {
                'damascus': 'Damascus - دمشق',
                'aleppo': 'Aleppo - حلب',
                'homs': 'Homs - حمص',
                'hama': 'Hama - حماة',
                'latakia': 'Latakia - اللاذقية',
                'tartus': 'Tartus - طرطوس',
                'idlib': 'Idlib - إدلب',
                'deraa': 'Deraa - درعا',
                'sweida': 'Sweida - السويداء',
                'quneitra': 'Quneitra - القنيطرة',
                'raqqa': 'Raqqa - الرقة',
                'deir_ez_zor': 'Deir ez-Zor - دير الزور',
                'hasakah': 'Hasakah - الحسكة',
                'rif_dimashq': 'Rif Dimashq - ريف دمشق'
            };
            return governorateNames[governorate] || governorate;
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function generateVendorCSV(data) {
            const headers = [
                'ID', 'Business Name', 'Owner Name', 'Email', 'Phone', 'Governorate',
                'Status', 'Tier', 'Rating', 'Products', 'Orders', 'Revenue', 'Commission'
            ];

            const rows = data.map(vendor => [
                vendor.id,
                vendor.businessName,
                vendor.ownerName,
                vendor.email,
                vendor.phone,
                getGovernorateDisplayName(vendor.governorate),
                vendor.status,
                vendor.tier,
                vendor.rating,
                vendor.totalProducts,
                vendor.totalOrders,
                vendor.monthlyRevenue,
                vendor.commission
            ]);

            return [headers, ...rows].map(row =>
                row.map(field => `"${field}"`).join(',')
            ).join('\n');
        }

        function downloadCSV(csv, filename) {
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        function showNotification(message, type = 'info') {
            console.log(`${type}: ${message}`);
        }

        /**
         * Mobile menu functionality
         */
        function initializeMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobileOverlay');

            mobileMenuBtn.addEventListener('click', function() {
                sidebar.classList.toggle('show');
                overlay.classList.toggle('hidden');
            });

            overlay.addEventListener('click', function() {
                sidebar.classList.remove('show');
                overlay.classList.add('hidden');
            });
        }

        /**
         * Toggle language
         */
        function toggleLanguage() {
            const htmlRoot = document.getElementById('htmlRoot');
            const currentLangElement = document.getElementById('currentLang');

            if (currentLanguage === 'en') {
                currentLanguage = 'ar';
                htmlRoot.setAttribute('dir', 'rtl');
                htmlRoot.setAttribute('lang', 'ar');
                currentLangElement.textContent = 'العربية';
            } else {
                currentLanguage = 'en';
                htmlRoot.setAttribute('dir', 'ltr');
                htmlRoot.setAttribute('lang', 'en');
                currentLangElement.textContent = 'EN';
            }
        }

        /**
         * Logout functionality
         */
        function logout() {
            const confirmed = confirm('Are you sure you want to logout?\nهل أنت متأكد من تسجيل الخروج؟');

            if (confirmed) {
                localStorage.removeItem('souqsyria_admin_user');
                window.location.href = '/admin-login.html';
            }
        }
    </script>
</body>
</html>